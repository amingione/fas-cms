<div id="product-filters" class="w-full flex flex-wrap justify-center items-center gap-4 sm:gap-10 py-4 px-2 border-b border-white/10 backdrop-blur-md">
  <div class="flex flex-wrap justify-center items-center gap-4 sm:gap-10 w-full">
    <div>
      <label for="vehicle-select" class="block mb-1 text-white">Select Vehicle</label>
      <select id="vehicle-select" class="bg-black text-white px-4 py-2 border border-white/20 rounded">
        <option value="">-- Select Vehicle --</option>
        <option value="Charger">Charger</option>
        <option value="Challenger">Challenger</option>
        <option value="TRX">TRX</option>
        <option value="Trackhawk">Trackhawk</option>
        <option value="Durango">Durango</option>
        <option value="Mustang">Mustang</option>
        <option value="Raptor">Raptor</option>
        <option value="F150">F150</option>
        <option value="F250">F250</option>
        <option value="F350">F350</option>
        <option value="F450">F450</option>
      </select>
    </div>

    <div>
      <label for="tune-select" class="block mb-1 text-white">Select Tune</label>
      <select id="tune-select" class="bg-black text-white px-4 py-2 border border-white/20 rounded">
        <option value="">-- Select Tune --</option>
        <option value="Required">Required</option>
        <option value="Not Required">Not Required</option>
      </select>
    </div>

    <div>
      <label for="hp-slider" class="block mb-1 text-white text-sm">Horsepower</label>
      <div class="flex items-center gap-2">
        <input type="range" min="600" max="1500" step="50" value="600" id="hp-slider" />
        <div class="text-xs text-gray-400" id="hp-output">600 WHP</div>
      </div>
    </div>
  </div>
</div>

<script>
  // Dispatch system to communicate filter changes to the main Astro page
  const filterState = {
    vehicle: null,
    tune: null,
    horsepower: 600,
  };

  document.getElementById('vehicle-select').addEventListener('change', (e) => {
    const target = e.target as HTMLSelectElement;
    filterState.vehicle = target.value;
    dispatchFilterChange();
  });

  document.getElementById('tune-select').addEventListener('change', (e) => {
    const target = e.target as HTMLSelectElement;
    filterState.tune = target.value;
    dispatchFilterChange();
  });

  const slider = document.getElementById('hp-slider');
  const output = document.getElementById('hp-output');
  slider.addEventListener('input', (e) => {
    const target = e.target as HTMLInputElement;
    filterState.horsepower = parseInt(target.value, 10);
    output.textContent = `Selected WHP: ${filterState.horsepower}`;
    dispatchFilterChange(); // Emit filter change event for Astro page to listen
  });

  function dispatchFilterChange() {
    const event = new CustomEvent('filterChange', { detail: filterState });
    document.dispatchEvent(event); // Dispatch the event with current filter state
  }
</script>
