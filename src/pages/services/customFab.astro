---
import BaseLayout from '@layouts/BaseLayout.astro';
import { loadPageDoc, inlineFieldAttrs, inlineObjectId } from '@lib/content';
import SectionRenderer from '@/components/SectionRenderer.astro';
import { Hero } from '@components/Hero.tsx';
const pageDoc: any = await loadPageDoc('customFab');
---

<BaseLayout>
  <div {...inlineObjectId('content/pages/customFab.json')}>
  <div aria-hidden="true" class="hidden" {...inlineFieldAttrs('title')}>{pageDoc?.title ?? 'Custom Fabrication'}</div>
  {Array.isArray(pageDoc?.sections) && pageDoc.sections.length > 0 && (
    <SectionRenderer sections={pageDoc.sections} baseFieldPath="sections" />
  )}

  <!-- HERO -->
  <section class="parallax-section custom-hero section-divider section-divider-carbon">
    <div class="background-layer">
      <img
        src="/images/fabrication/FAS-Fabrication-1.png"
        alt="FAS Motorsports Custom Fabrication"
        class="absolute inset-0 w-full h-full object-cover object-center"
        loading="eager"
      />
    </div>
    <div class="foreground-layer !pt-32 md:!pt-40">
      <h1 class="text-4xl md:text-6xl font-ethno text-accent drop-shadow mb-3" {...inlineFieldAttrs('title')}>
        {pageDoc?.title ?? 'Custom Fabrication & Welding'}
      </h1>
      <p class="text-white/80 max-w-3xl mx-auto font-mono text-base md:text-xl tracking-wide">
        FAS Motorsports offers in-house custom fabrication services for performance and diesel platforms. From pipes and cats to full exhaust systems, our welding department designs and builds everything to spec — no compromises.
      </p>
    </div>
  </section>

  <!-- CAPABILITIES SUMMARY (professional overview) -->
  <section class="bg-black/70 border-y border-white/20 py-10 md:py-14">
    <div class="mx-auto w-full max-w-7xl px-0 md:px-6">
      <h2 class="text-3xl md:text-4xl font-ethno text-accent mb-4">Capabilities &amp; Scope</h2>
      <p class="text-white/75 font-mono text-base md:text-lg mb-8 max-w-4xl">
        FAS Motorsports operates a full in‑house fabrication and welding department that designs, prototypes, and produces custom exhaust, catalyst, and piping systems for both gasoline and diesel applications. We handle one‑off projects, production runs, and motorsport‑grade assemblies with controlled QA.
      </p>

      <!-- matrix -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
        <div class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
          <h3 class="text-lg font-borg text-white mb-2">Core Services</h3>
          <ul class="list-disc pl-5 text-white/70 text-sm space-y-1.5">
            <li>Bespoke exhaust systems (cat‑back, axle‑back, turbo‑back)</li>
            <li>High‑flow catalyst integration &amp; placement</li>
            <li>Charge pipes, downpipes, hot/cold side routing</li>
            <li>Diesel truck systems (3.0L–6.7L), heavy‑duty hardware</li>
            <li>Hanger/bracket design, flex‑joint positioning</li>
            <li>Prototype to small‑batch production</li>
          </ul>
        </div>
        <div class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
          <h3 class="text-lg font-borg text-white mb-2">Materials &amp; Processes</h3>
          <ul class="list-disc pl-5 text-white/70 text-sm space-y-1.5">
            <li>304 &amp; 316L stainless, aluminized steel, titanium (by request)</li>
            <li>Mandrel bends, pie‑cut sections, CNC‑cut flanges</li>
            <li>TIG (primary) &amp; MIG (structural) welding methods</li>
            <li>Back‑purged stainless welds; argon purge procedures</li>
            <li>V‑band, slip‑fit, and OEM‑style couplers</li>
            <li>Brushed, satin, or ceramic‑coat finishes</li>
          </ul>
        </div>
        <div class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
          <h3 class="text-lg font-borg text-white mb-2">Quality &amp; Standards</h3>
          <ul class="list-disc pl-5 text-white/70 text-sm space-y-1.5">
            <li>Fitment checked on‑vehicle or jig fixtures</li>
            <li>Leak‑check at joints; dye penetrant as required</li>
            <li>Weld bead inspection; heat‑affected zone control</li>
            <li>Dimensional checks vs. CAD or recorded jigs</li>
            <li>Documentation: materials, process notes, torque specs</li>
            <li>Emissions: customer‑informed compliance where applicable*</li>
          </ul>
        </div>
      </div>

      <p class="text-white/55 text-xs mt-4">* Emissions compliance varies by jurisdiction and vehicle use. We build to the customer’s stated purpose and local regulations.</p>
    </div>
  </section>

  <!-- GAS & DIESEL USE‑CASES (more informative than generic blocks) -->
  <section class="py-10 md:py-14">
    <div class="mx-auto w-full max-w-7xl px-0 md:px-6 grid md:grid-cols-2 gap-6 md:gap-8">
      <div class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
        <h3 class="text-xl font-ethno text-primary mb-2">Gasoline Performance</h3>
        <p class="text-white/70 text-sm leading-relaxed mb-4">
          For forced‑induction and high‑RPM builds, we prioritize flow and thermal stability. Typical deliverables include cat‑back systems with optimized muffler cores, heat‑managed downpipes, and charge‑pipe routing that minimizes volume while maintaining laminar flow to the throttle body.
        </p>
        <ul class="list-disc pl-5 text-white/70 text-sm space-y-1.5">
          <li>Thin‑wall 304SS with back‑purged TIG for lightweight durability</li>
          <li>Flex joints placed to protect turbo/manifold from drivetrain movement</li>
          <li>O2 sensor bung placement for accurate readings &amp; serviceability</li>
        </ul>
      </div>
      <div class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
        <h3 class="text-xl font-ethno text-primary mb-2">Diesel Applications</h3>
        <p class="text-white/70 text-sm leading-relaxed mb-4">
          Diesel exhaust systems require robustness against continuous high EGT and vibration. We design for clearance, hanger reinforcement, and expansion, with provisions for larger‑frame turbos and work‑duty cycles.
        </p>
        <ul class="list-disc pl-5 text-white/70 text-sm space-y-1.5">
          <li>Thicker‑gauge stainless or aluminized steel for longevity</li>
          <li>Reinforced hangers and bracing for heavy systems</li>
          <li>Optional resonators/mufflers to control drone under load</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- PROCESS: HOW WE WORK (stepper) -->
  <section class="bg-black/70 border-y border-white/20 py-10 md:py-14">
    <div class="mx-auto w-full max-w-7xl px-0 md:px-6">
      <h2 class="text-2xl md:text-3xl font-ethno text-accent mb-6">Process &amp; Deliverables</h2>
      <ol class="grid grid-cols-1 md:grid-cols-4 gap-4 md:gap-6 text-white/80 text-sm">
        <li class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
          <div class="text-primary font-borg text-lg mb-1">1. Consult</div>
          <p class="text-white/70">Define goals, constraints, budget, and intended use (street, track, work duty).</p>
        </li>
        <li class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
          <div class="text-primary font-borg text-lg mb-1">2. Design</div>
          <p class="text-white/70">On‑car measurement and CAD mock‑ups; choose materials, bends, joint types, and finish.</p>
        </li>
        <li class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
          <div class="text-primary font-borg text-lg mb-1">3. Fabricate</div>
          <p class="text-white/70">Mandrel bending, precision TIG welds with back purge; fixtures for repeatability.</p>
        </li>
        <li class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
          <div class="text-primary font-borg text-lg mb-1">4. Validate</div>
          <p class="text-white/70">Fitment check, leak‑test, and final finish. Install in‑house with torque specs documented.</p>
        </li>
      </ol>
    </div>
  </section>

  <!-- IMAGE GALLERY WITH CAPTIONS -->
  <section class="bg-black/70 py-10 md:py-14">
    <div class="mx-auto w-full max-w-7xl grid md:grid-cols-2 gap-6 px-0 md:px-6">
      <figure class="rounded-xl border border-white/20 bg-black/50 overflow-hidden shadow-xl">
        <img src="/images/fabrication/FAS-Fabrication-2.png" alt="Precision fitment on vehicle" class="w-full h-[320px] object-cover" />
        <figcaption class="p-3 text-white/70 text-sm">Mock‑up &amp; fitment checks prior to final weld‑out.</figcaption>
      </figure>
      <figure class="rounded-xl border border-white/20 bg-black/50 overflow-hidden shadow-xl">
        <img src="/images/fabrication/FAS-Fabrication-Installation.png" alt="Installation stage" class="w-full h-[320px] object-cover" />
        <figcaption class="p-3 text-white/70 text-sm">In‑house installation with documented torque and hanger positions.</figcaption>
      </figure>
      <figure class="rounded-xl border border-white/20 bg-black/50 overflow-hidden shadow-xl md:col-span-2">
        <img src="/images/fabrication/FAS-Welding.png" alt="Back‑purged TIG welding" class="w-full h-[380px] object-cover" />
        <figcaption class="p-3 text-white/70 text-sm">Back‑purged TIG welds for corrosion resistance and interior smoothness.</figcaption>
      </figure>
    </div>
  </section>

  <!-- TECHNICAL NOTES & OPTIONS -->
  <section class="py-10 md:py-14">
    <div class="mx-auto w-full max-w-7xl px-0 md:px-6 grid md:grid-cols-3 gap-6">
      <div class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
        <h3 class="text-lg font-borg text-white mb-2">Options &amp; Upgrades</h3>
        <ul class="list-disc pl-5 text-white/70 text-sm space-y-1.5">
          <li>High‑flow catalysts, resonators, muffler core selection</li>
          <li>Heat shielding, lava wrap, ceramic coatings</li>
          <li>O2 bung relocation, wideband provisions, EGT ports</li>
          <li>V‑band conversions, quick‑release clamps</li>
        </ul>
      </div>
      <div class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
        <h3 class="text-lg font-borg text-white mb-2">Tolerances &amp; Fitment</h3>
        <ul class="list-disc pl-5 text-white/70 text-sm space-y-1.5">
          <li>Jig or on‑car builds held within ±2 mm typical</li>
          <li>Flange flatness ≤ 0.15 mm; concentric alignment verified</li>
          <li>Hanger locations recorded for repeatable service</li>
        </ul>
      </div>
      <div class="rounded-xl border border-white/20 bg-black/60 p-5 shadow-xl">
        <h3 class="text-lg font-borg text-white mb-2">Lead Times &amp; Pricing</h3>
        <ul class="list-disc pl-5 text-white/70 text-sm space-y-1.5">
          <li>Consult → quote: 1–3 business days</li>
          <li>Typical fabrication window: 5–10 business days</li>
          <li>Expedite options available; production runs quoted separately</li>
        </ul>
      </div>
    </div>
  </section>


  <section>
    <Hero client:load />
  </section>
</BaseLayout>

<style>
  .custom-hero {
    height: 60vh;
  }

  @media (min-width: 768px) {
    .custom-hero {
      height: 80vh;
    }
  }
</style>
