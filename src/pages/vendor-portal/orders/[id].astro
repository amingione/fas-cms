---
import VendorPortalLayout from '@/layouts/VendorPortalLayout.astro';
import OrderDetail from '@/components/vendor-portal/OrderDetail';

const { id } = Astro.params;
const apiUrl = new URL(`/api/vendor/orders/${id}`, Astro.request.url).toString();
const res = await fetch(apiUrl, { headers: { cookie: Astro.request.headers.get('cookie') || '' } });
let order: any = null;
if (res.ok) {
  const data = await res.json().catch(() => ({}));
  order = data.order || null;
}
if (!order) {
  return Astro.redirect('/vendor-portal/orders');
}
const title = `Order ${order.orderNumber || id}`;
---

<VendorPortalLayout title={title} noindex>
  <div class="text-white">
    <OrderDetail order={order} client:load />
  </div>
</VendorPortalLayout>
